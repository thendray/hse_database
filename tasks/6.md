# Задание 6

## Задание 1

Возьмите реляционную схему для библиотеки сделаную в задании 3.1:

* Reader( <ins>number</ins>, LastName, FirstName, Address, BirthDate) <br>
* Book ( <ins>isbn</ins>, Title, Author, PagesNum, PubYear, PubName) <br>
* Publisher ( <ins>PubName</ins>, PubAdress) <br>
* Category ( <ins>CategoryName</ins>, ParentCat) <br>
* Copy ( <ins>ISBN, CopyNumber</ins>,, ShelfPosition) <br>

* Borrowing ( <ins>ReaderNr, ISBN, CopyNumber</ins>, ReturnDate) <br>
* BookCat ( <ins>ISBN, CategoryName</ins> )

---

**1** Показать все названия книг вместе с именами издателей.

```sql
SELECT author, title FROM book
```

**2** В какой книге наибольшее количество страниц?

```sql
SELECT * FROM book ORDER BY pagesnum DESC LIMIT 1
```

**3** Какие авторы написали более 5 книг?

```sql
SELECT author, COUNT(*) as books_count
FROM book
GROUP BY author
HAVING COUNT(*) > 5
```

**4** В каких книгах более чем в два раза больше страниц, чем среднее количество страниц для всех книг?
SELECT title, pagesnum 
FROM book
WHERE pagesnum > 2 * (SELECT avg(pagesnum) FROM book)
```sql

```

**5** Какие категории содержат подкатегории?

```sql
SELECT categoryname
FROM category
WHERE (parentcat IS NOT NULL)
```

**6** У какого автора (предположим, что имена авторов уникальны) написано максимальное количество книг?

```sql
SELECT author
FROM book
GROUP BY author
ORDER BY COUNT(*) DESC
LIMIT 1
```

**7** Какие читатели забронировали все книги (не копии), написанные "Марком Твеном"?

```sql
SELECT r.firstname, r.lastname
FROM reader r
WHERE NOT EXISTS(
        SELECT b.isbn
        FROM book as b
        WHERE b.author LIKE '%Марк Твен%'
          AND NOT EXISTS
            (SELECT br.isbn
             FROM borrowing br
             WHERE br.readernr = r.id
               AND br.isbn = b.isbn));
```

**8** Какие книги имеют более одной копии?

```sql
SELECT book.isbn, title
FROM book
         JOIN copy c on book.isbn = c.isbn
GROUP BY book.isbn, book.title
HAVING COUNT(c.isbn) > 1
```

**9** ТОП 10 самых старых книг 

```sql

```

**10** Перечислите все категории в категории “Спорт” (с любым уровнем вложености).

```sql

```

---

## Задание 2
